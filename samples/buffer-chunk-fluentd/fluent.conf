<source>
  @type tail
  @label @raw
  path /fluentd/log/sample/*.log
  pos_file /fluentd/log/sample.log.pos
  tag foo.bar
  read_from_head true
  <parse>
    @type json
  </parse>
</source>

<label @raw>
  <match **>
    @type stdout
    # chunk_limit_size * chunk_full_threshold (== 8MB * 0.95 in default)
    <buffer year,month,day>
      @type file
      path /fluentd/
      timekey      1m
      timekey_wait 10s
      chunk_limit_records 3
      chunk_limit_size 2MB
      chunk_full_threshold 0.9
    </buffer>
    flush_interval 20s
  </match>
</label>
